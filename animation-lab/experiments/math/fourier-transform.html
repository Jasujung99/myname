<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í‘¸ë¦¬ì— ë³€í™˜ ì‹œê°í™”</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0a0a0a;
            --primary-color: #1a1a1a;
            --secondary-color: #2a2a2a;
            --text-color: #e0e0e0;
            --accent-color: #00aaff;
            --button-bg: #333;
            --button-hover: #555;
            --grid-color: #333;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, var(--bg-color) 0%, #1a1a2e 50%, #16213e 100%);
            color: var(--text-color);
            overflow: hidden;
            height: 100vh;
        }
        
        .container {
            display: flex;
            height: 100vh;
        }
        
        .canvas-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            gap: 20px;
            min-height: 0; /* í”Œë ‰ìŠ¤ ì•„ì´í…œì´ ì¶•ì†Œë  ìˆ˜ ìˆë„ë¡ */
        }
        
        .canvas-section {
            flex: 1;
            background: rgba(26, 26, 26, 0.9);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid #333;
            min-height: 0; /* í”Œë ‰ìŠ¤ ì•„ì´í…œì´ ì¶•ì†Œë  ìˆ˜ ìˆë„ë¡ */
            display: flex;
            flex-direction: column;
        }
        
        .canvas-section h3 {
            color: var(--accent-color);
            margin-bottom: 10px;
            font-size: 1.1rem;
            flex-shrink: 0; /* ì œëª©ì€ ì¶•ì†Œë˜ì§€ ì•Šë„ë¡ */
        }
        
        canvas {
            width: 100%;
            flex: 1; /* ë‚¨ì€ ê³µê°„ì„ ëª¨ë‘ ì°¨ì§€ */
            min-height: 200px; /* ìµœì†Œ ë†’ì´ ì„¤ì • */
            background: var(--primary-color);
            border-radius: 8px;
            border: 1px solid var(--grid-color);
        }
        
        .controls {
            width: 350px;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(10px);
            border-left: 1px solid #333;
            padding: 20px;
            overflow-y: auto;
        }
        
        .control-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--secondary-color);
        }
        
        .control-header h1 {
            font-size: 1.5rem;
            color: var(--accent-color);
            margin-bottom: 5px;
        }
        
        .control-header p {
            color: #999;
            font-size: 0.9rem;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        .control-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .control-value {
            color: var(--accent-color);
            font-family: 'Courier New', monospace;
        }
        
        input[type="range"] {
            width: 100%;
            height: 6px;
            background: var(--secondary-color);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: var(--accent-color);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 10px var(--accent-color);
        }
        
        .wave-controls {
            background: var(--secondary-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .wave-controls h4 {
            color: var(--accent-color);
            margin-bottom: 10px;
            font-size: 1rem;
        }
        
        .wave-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .wave-checkbox {
            width: 16px;
            height: 16px;
            margin-right: 10px;
        }
        
        .wave-color {
            width: 20px;
            height: 16px;
            margin-right: 10px;
            border-radius: 3px;
        }
        
        .wave-label {
            flex: 1;
            font-size: 0.9rem;
        }
        
        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .preset-button {
            padding: 8px 12px;
            background: var(--button-bg);
            color: var(--text-color);
            border: 1px solid #555;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.85rem;
        }
        
        .preset-button:hover {
            background: var(--button-hover);
            border-color: var(--accent-color);
        }
        
        .preset-button.active {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: #000;
        }
        
        .info-section {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .info-section h4 {
            color: var(--accent-color);
            margin-bottom: 10px;
            font-size: 1rem;
        }
        
        .info-section p {
            font-size: 0.85rem;
            line-height: 1.5;
            color: #ccc;
            margin-bottom: 8px;
        }
        
        .back-button {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            text-decoration: none;
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .back-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                height: 100vh;
            }
            
            .controls {
                width: 100%;
                max-height: 40vh;
                order: -1; /* ì»¨íŠ¸ë¡¤ì„ ìœ„ë¡œ ì´ë™ */
            }
            
            .canvas-area {
                flex: 1;
                min-height: 0;
                padding: 10px;
                gap: 10px;
            }
            
            .canvas-section {
                min-height: 150px; /* ëª¨ë°”ì¼ì—ì„œ ìµœì†Œ ë†’ì´ */
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="canvas-area">
            <div class="canvas-section">
                <h3>ğŸ“Š ì‹œê°„ ì˜ì—­ (Time Domain)</h3>
                <canvas id="timeCanvas"></canvas>
            </div>
            
            <div class="canvas-section">
                <h3>ğŸ”Š ì£¼íŒŒìˆ˜ ì˜ì—­ (Frequency Domain)</h3>
                <canvas id="frequencyCanvas"></canvas>
            </div>
        </div>
        
        <div class="controls">
            <div class="control-header">
                <h1>ğŸŒŠ í‘¸ë¦¬ì— ë³€í™˜</h1>
                <p>íŒŒí˜•ì„ ì£¼íŒŒìˆ˜ ì„±ë¶„ìœ¼ë¡œ ë¶„í•´</p>
            </div>
            
            <div class="preset-buttons">
                <button class="preset-button active" data-preset="sine">ê¸°ë³¸ ì‚¬ì¸íŒŒ</button>
                <button class="preset-button" data-preset="square">ì‚¬ê°íŒŒ</button>
                <button class="preset-button" data-preset="sawtooth">í†±ë‹ˆíŒŒ</button>
                <button class="preset-button" data-preset="triangle">ì‚¼ê°íŒŒ</button>
                <button class="preset-button" data-preset="noise">í™”ì´íŠ¸ ë…¸ì´ì¦ˆ</button>
                <button class="preset-button" data-preset="custom">ì‚¬ìš©ì ì •ì˜</button>
            </div>
            
            <div class="control-group">
                <div class="control-label">
                    <span>ê¸°ë³¸ ì£¼íŒŒìˆ˜</span>
                    <span class="control-value" id="fundamentalValue">2.0 Hz</span>
                </div>
                <input type="range" id="fundamental" min="0.5" max="10" step="0.1" value="2">
            </div>
            
            <div class="control-group">
                <div class="control-label">
                    <span>ìƒ˜í”Œë§ ì£¼íŒŒìˆ˜</span>
                    <span class="control-value" id="sampleRateValue">100 Hz</span>
                </div>
                <input type="range" id="sampleRate" min="50" max="500" step="10" value="100">
            </div>
            
            <div class="control-group">
                <div class="control-label">
                    <span>ì‹œê°„ ìœˆë„ìš°</span>
                    <span class="control-value" id="timeWindowValue">2.0 ì´ˆ</span>
                </div>
                <input type="range" id="timeWindow" min="0.5" max="5" step="0.1" value="2">
            </div>
            
            <div class="wave-controls">
                <h4>ğŸµ í•˜ëª¨ë‹‰ ì„±ë¶„</h4>
                <div id="harmonicsContainer"></div>
            </div>
            
            <div class="control-group">
                <div class="control-label">
                    <span>ë…¸ì´ì¦ˆ ë ˆë²¨</span>
                    <span class="control-value" id="noiseValue">0%</span>
                </div>
                <input type="range" id="noise" min="0" max="50" step="1" value="0">
            </div>
            
            <div class="info-section">
                <h4>ğŸ“š í•™ìŠµ í¬ì¸íŠ¸</h4>
                <p><strong>ì‹œê°„ ì˜ì—­:</strong> ì‹œê°„ì— ë”°ë¥¸ ì‹ í˜¸ì˜ ì§„í­ ë³€í™”ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
                <p><strong>ì£¼íŒŒìˆ˜ ì˜ì—­:</strong> ì‹ í˜¸ë¥¼ êµ¬ì„±í•˜ëŠ” ê° ì£¼íŒŒìˆ˜ ì„±ë¶„ì˜ ê°•ë„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
                <p><strong>í‘¸ë¦¬ì— ë³€í™˜:</strong> ë³µì¡í•œ ì‹ í˜¸ë¥¼ ë‹¨ìˆœí•œ ì‚¬ì¸íŒŒë“¤ì˜ í•©ìœ¼ë¡œ ë¶„í•´í•˜ëŠ” ìˆ˜í•™ì  ë„êµ¬ì…ë‹ˆë‹¤.</p>
                <p><strong>í•˜ëª¨ë‹‰:</strong> ê¸°ë³¸ ì£¼íŒŒìˆ˜ì˜ ì •ìˆ˜ë°° ì£¼íŒŒìˆ˜ë“¤ë¡œ, ìŒìƒ‰ì„ ê²°ì •í•©ë‹ˆë‹¤.</p>
                <p><strong>ë…¸ì´ì¦ˆ ë ˆë²¨:</strong> ì›ë³¸ ì‹ í˜¸ì— ì¶”ê°€ë˜ëŠ” ëœë¤ ì¡ìŒì˜ ê°•ë„ì…ë‹ˆë‹¤. ì‹¤ì œ ì‹ í˜¸ëŠ” í•­ìƒ ë…¸ì´ì¦ˆë¥¼ í¬í•¨í•˜ë©°, ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œ ì „ì²´ì ì¸ ë°”ë‹¥ ë ˆë²¨ì„ ë†’ì…ë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>
    
    <a href="../../index.html" class="back-button">â† ë©”ì¸ìœ¼ë¡œ</a>
    
    <script>
        class FourierVisualizer {
            constructor() {
                this.timeCanvas = document.getElementById('timeCanvas');
                this.frequencyCanvas = document.getElementById('frequencyCanvas');
                this.timeCtx = this.timeCanvas.getContext('2d');
                this.frequencyCtx = this.frequencyCanvas.getContext('2d');
                
                this.params = {
                    fundamental: 2.0,
                    sampleRate: 100,
                    timeWindow: 2.0,
                    noise: 0,
                    preset: 'sine'
                };
                
                this.harmonics = [
                    { frequency: 1, amplitude: 1.0, phase: 0, active: true, color: '#ff6b6b' },
                    { frequency: 2, amplitude: 0.5, phase: 0, active: false, color: '#4ecdc4' },
                    { frequency: 3, amplitude: 0.33, phase: 0, active: false, color: '#45b7d1' },
                    { frequency: 4, amplitude: 0.25, phase: 0, active: false, color: '#96ceb4' },
                    { frequency: 5, amplitude: 0.2, phase: 0, active: false, color: '#feca57' },
                    { frequency: 6, amplitude: 0.17, phase: 0, active: false, color: '#ff9ff3' },
                    { frequency: 7, amplitude: 0.14, phase: 0, active: false, color: '#54a0ff' },
                    { frequency: 8, amplitude: 0.125, phase: 0, active: false, color: '#5f27cd' }
                ];
                
                this.animationId = null;
                this.time = 0;
                this.timeOffset = 0; // íŒŒí˜• ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•œ ì‹œê°„ ì˜¤í”„ì…‹
                
                this.initCanvas();
                this.setupControls();
                this.setupHarmonics();
                this.setupPresets();
                this.updateNoiseSliderState('sine'); // ì´ˆê¸° ìƒíƒœ ì„¤ì •
                this.animate();
            }
            
            initCanvas() {
                const resizeCanvas = (canvas) => {
                    const rect = canvas.getBoundingClientRect();
                    const dpr = window.devicePixelRatio || 1;
                    
                    // ì‹¤ì œ í”½ì…€ í¬ê¸° ì„¤ì •
                    canvas.width = rect.width * dpr;
                    canvas.height = rect.height * dpr;
                    
                    // CSS í¬ê¸° ì„¤ì •
                    canvas.style.width = rect.width + 'px';
                    canvas.style.height = rect.height + 'px';
                    
                    const ctx = canvas.getContext('2d');
                    ctx.scale(dpr, dpr);
                };
                
                // ì´ˆê¸° ë¦¬ì‚¬ì´ì§•
                const resize = () => {
                    resizeCanvas(this.timeCanvas);
                    resizeCanvas(this.frequencyCanvas);
                };
                
                // ì¡°ê¸ˆ ì§€ì—°ì‹œì¼œì„œ ë ˆì´ì•„ì›ƒì´ ì™„ì „íˆ ì•ˆì •ëœ í›„ ë¦¬ì‚¬ì´ì§•
                setTimeout(resize, 100);
                
                window.addEventListener('resize', () => {
                    setTimeout(resize, 100);
                });
            }
            
            setupControls() {
                const controls = {
                    fundamental: { element: 'fundamental', display: 'fundamentalValue', unit: ' Hz' },
                    sampleRate: { element: 'sampleRate', display: 'sampleRateValue', unit: ' Hz' },
                    timeWindow: { element: 'timeWindow', display: 'timeWindowValue', unit: ' ì´ˆ' },
                    noise: { element: 'noise', display: 'noiseValue', unit: '%' }
                };
                
                Object.entries(controls).forEach(([param, config]) => {
                    const element = document.getElementById(config.element);
                    const display = document.getElementById(config.display);
                    
                    element.addEventListener('input', (e) => {
                        this.params[param] = parseFloat(e.target.value);
                        display.textContent = e.target.value + config.unit;
                    });
                    
                    // ì´ˆê¸°ê°’ ì„¤ì •
                    display.textContent = element.value + config.unit;
                });
            }
            
            setupHarmonics() {
                const container = document.getElementById('harmonicsContainer');
                
                this.harmonics.forEach((harmonic, index) => {
                    const item = document.createElement('div');
                    item.className = 'wave-item';
                    
                    item.innerHTML = `
                        <input type="checkbox" class="wave-checkbox" ${harmonic.active ? 'checked' : ''} 
                               data-harmonic="${index}">
                        <div class="wave-color" style="background: ${harmonic.color}"></div>
                        <span class="wave-label">${harmonic.frequency}ì°¨ í•˜ëª¨ë‹‰ (${(harmonic.amplitude * 100).toFixed(0)}%)</span>
                    `;
                    
                    const checkbox = item.querySelector('.wave-checkbox');
                    checkbox.addEventListener('change', (e) => {
                        this.harmonics[index].active = e.target.checked;
                    });
                    
                    container.appendChild(item);
                });
            }
            
            setupPresets() {
                const buttons = document.querySelectorAll('.preset-button');
                
                buttons.forEach(button => {
                    button.addEventListener('click', () => {
                        buttons.forEach(b => b.classList.remove('active'));
                        button.classList.add('active');
                        
                        const preset = button.dataset.preset;
                        this.params.preset = preset;
                        this.applyPreset(preset);
                        this.updateNoiseSliderState(preset); // ë…¸ì´ì¦ˆ ìŠ¬ë¼ì´ë” ìƒíƒœ ì—…ë°ì´íŠ¸
                    });
                });
            }
            
            applyPreset(preset) {
                // ëª¨ë“  í•˜ëª¨ë‹‰ ë¹„í™œì„±í™”
                this.harmonics.forEach(h => h.active = false);
                
                switch(preset) {
                    case 'sine':
                        this.harmonics[0].active = true;
                        break;
                    case 'square':
                        this.harmonics.forEach((h, i) => {
                            if (h.frequency % 2 === 1) { // í™€ìˆ˜ í•˜ëª¨ë‹‰ë§Œ
                                h.active = true;
                                h.amplitude = 1.0 / h.frequency;
                            }
                        });
                        break;
                    case 'sawtooth':
                        this.harmonics.forEach((h, i) => {
                            h.active = true;
                            h.amplitude = 1.0 / h.frequency;
                        });
                        break;
                    case 'triangle':
                        this.harmonics.forEach((h, i) => {
                            if (h.frequency % 2 === 1) { // í™€ìˆ˜ í•˜ëª¨ë‹‰ë§Œ
                                h.active = true;
                                h.amplitude = 1.0 / (h.frequency * h.frequency);
                            }
                        });
                        break;
                    case 'custom':
                        this.harmonics[0].active = true;
                        this.harmonics[2].active = true;
                        this.harmonics[4].active = true;
                        break;
                }
                
                this.updateHarmonicsDisplay();
            }
            
            updateHarmonicsDisplay() {
                const checkboxes = document.querySelectorAll('.wave-checkbox');
                checkboxes.forEach((checkbox, index) => {
                    checkbox.checked = this.harmonics[index].active;
                });
            }
            
            updateNoiseSliderState(preset) {
                const noiseSlider = document.getElementById('noise');
                const noiseGroup = noiseSlider.closest('.control-group');
                
                if (preset === 'noise') {
                    // í™”ì´íŠ¸ ë…¸ì´ì¦ˆì¼ ë•Œ ìŠ¬ë¼ì´ë” ë¹„í™œì„±í™”
                    noiseSlider.disabled = true;
                    noiseGroup.style.opacity = '0.5';
                    noiseGroup.style.pointerEvents = 'none';
                } else {
                    // ë‹¤ë¥¸ íŒŒí˜•ì¼ ë•Œ ìŠ¬ë¼ì´ë” í™œì„±í™”
                    noiseSlider.disabled = false;
                    noiseGroup.style.opacity = '1';
                    noiseGroup.style.pointerEvents = 'auto';
                }
            }
            
            generateSignal() {
                const duration = this.params.timeWindow;
                const sampleRate = this.params.sampleRate;
                const samples = Math.floor(duration * sampleRate);
                const signal = new Array(samples);
                const timeStep = duration / samples;
                
                for (let i = 0; i < samples; i++) {
                    const t = i * timeStep + this.timeOffset; // ì‹œê°„ ì˜¤í”„ì…‹ ì¶”ê°€ë¡œ íŒŒí˜• ì• ë‹ˆë©”ì´ì…˜
                    let value = 0;
                    
                    if (this.params.preset === 'noise') {
                        value = (Math.random() - 0.5) * 2;
                    } else {
                        // í™œì„±í™”ëœ í•˜ëª¨ë‹‰ë“¤ì„ í•©ì„±
                        this.harmonics.forEach(harmonic => {
                            if (harmonic.active) {
                                const freq = harmonic.frequency * this.params.fundamental;
                                const amplitude = harmonic.amplitude;
                                const phase = harmonic.phase;
                                value += amplitude * Math.sin(2 * Math.PI * freq * t + phase);
                            }
                        });
                        
                        // ë…¸ì´ì¦ˆ ì¶”ê°€ (í™”ì´íŠ¸ ë…¸ì´ì¦ˆê°€ ì•„ë‹ ë•Œë§Œ)
                        if (this.params.noise > 0) {
                            const noiseAmp = this.params.noise / 100;
                            value += (Math.random() - 0.5) * 2 * noiseAmp;
                        }
                    }
                    
                    signal[i] = value;
                }
                
                return signal;
            }
            
            computeFFT(signal) {
                const N = signal.length;
                const frequencies = [];
                const magnitudes = [];
                
                // ê°„ë‹¨í•œ DFT êµ¬í˜„ (ì‹¤ì œ FFTë³´ë‹¤ ëŠë¦¬ì§€ë§Œ êµìœ¡ìš©ìœ¼ë¡œ ì¶©ë¶„)
                for (let k = 0; k < N / 2; k++) {
                    let real = 0;
                    let imag = 0;
                    
                    for (let n = 0; n < N; n++) {
                        const angle = -2 * Math.PI * k * n / N;
                        real += signal[n] * Math.cos(angle);
                        imag += signal[n] * Math.sin(angle);
                    }
                    
                    const magnitude = Math.sqrt(real * real + imag * imag) / N * 2;
                    const frequency = k * this.params.sampleRate / N;
                    
                    frequencies.push(frequency);
                    magnitudes.push(magnitude);
                }
                
                return { frequencies, magnitudes };
            }
            
            drawTimeData(signal) {
                const canvas = this.timeCanvas;
                const ctx = this.timeCtx;
                const rect = canvas.getBoundingClientRect();
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                // ê²©ì ê·¸ë¦¬ê¸°
                this.drawGrid(ctx, rect.width, rect.height);
                
                // ì‹ í˜¸ ê·¸ë¦¬ê¸°
                ctx.strokeStyle = '#00aaff';
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                const duration = this.params.timeWindow;
                const samples = signal.length;
                
                for (let i = 0; i < samples; i++) {
                    const x = (i / samples) * rect.width;
                    const y = rect.height / 2 - (signal[i] / 2) * (rect.height / 2 - 20);
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                
                ctx.stroke();
                
                // ì¶• ë ˆì´ë¸”
                this.drawTimeLabels(ctx, rect.width, rect.height, duration);
            }
            
            drawFrequencyData(fftResult) {
                const canvas = this.frequencyCanvas;
                const ctx = this.frequencyCtx;
                const rect = canvas.getBoundingClientRect();
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                // ê²©ì ê·¸ë¦¬ê¸°
                this.drawGrid(ctx, rect.width, rect.height);
                
                const { frequencies, magnitudes } = fftResult;
                const maxFreq = Math.min(frequencies[frequencies.length - 1], this.params.fundamental * 10);
                const maxMag = Math.max(...magnitudes) * 1.1;
                
                // ë§‰ëŒ€ ê·¸ë˜í”„ë¡œ ê·¸ë¦¬ê¸°
                const barWidth = rect.width / frequencies.length;
                
                frequencies.forEach((freq, i) => {
                    if (freq <= maxFreq) {
                        const x = (freq / maxFreq) * rect.width;
                        const height = (magnitudes[i] / maxMag) * (rect.height - 40);
                        const y = rect.height - 20 - height;
                        
                        // í•˜ëª¨ë‹‰ì¸ì§€ í™•ì¸í•˜ê³  ìƒ‰ìƒ ì„¤ì •
                        let color = '#666';
                        const harmonicIndex = Math.round(freq / this.params.fundamental) - 1;
                        if (harmonicIndex >= 0 && harmonicIndex < this.harmonics.length) {
                            const expectedFreq = (harmonicIndex + 1) * this.params.fundamental;
                            if (Math.abs(freq - expectedFreq) < 0.5) {
                                color = this.harmonics[harmonicIndex].color;
                            }
                        }
                        
                        ctx.fillStyle = color;
                        ctx.fillRect(x - barWidth/2, y, barWidth * 0.8, height);
                    }
                });
                
                // ì¶• ë ˆì´ë¸”
                this.drawFrequencyLabels(ctx, rect.width, rect.height, maxFreq);
            }
            
            drawGrid(ctx, width, height) {
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                
                // ìˆ˜ì§ì„ 
                for (let i = 0; i <= 10; i++) {
                    const x = (i / 10) * width;
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, height);
                    ctx.stroke();
                }
                
                // ìˆ˜í‰ì„ 
                for (let i = 0; i <= 10; i++) {
                    const y = (i / 10) * height;
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(width, y);
                    ctx.stroke();
                }
            }
            
            drawTimeLabels(ctx, width, height, duration) {
                ctx.fillStyle = '#999';
                ctx.font = '12px monospace';
                ctx.textAlign = 'center';
                
                for (let i = 0; i <= 5; i++) {
                    const x = (i / 5) * width;
                    const time = (i / 5) * duration;
                    ctx.fillText(`${time.toFixed(1)}s`, x, height - 5);
                }
                
                // Yì¶• ë ˆì´ë¸”
                ctx.textAlign = 'left';
                ctx.fillText('1', 5, 15);
                ctx.fillText('0', 5, height / 2);
                ctx.fillText('-1', 5, height - 25);
            }
            
            drawFrequencyLabels(ctx, width, height, maxFreq) {
                ctx.fillStyle = '#999';
                ctx.font = '12px monospace';
                ctx.textAlign = 'center';
                
                for (let i = 0; i <= 5; i++) {
                    const x = (i / 5) * width;
                    const freq = (i / 5) * maxFreq;
                    ctx.fillText(`${freq.toFixed(1)}Hz`, x, height - 5);
                }
            }
            
            animate() {
                const signal = this.generateSignal();
                const fftResult = this.computeFFT(signal);
                
                this.drawTimeData(signal);
                this.drawFrequencyData(fftResult);
                
                this.time += 0.016; // ~60fps
                this.timeOffset += 0.05; // íŒŒí˜•ì´ í˜ëŸ¬ê°€ëŠ” ì†ë„
                this.animationId = requestAnimationFrame(() => this.animate());
            }
        }
        
        // ì´ˆê¸°í™”
        window.addEventListener('load', () => {
            new FourierVisualizer();
        });
    </script>
</body>
</html>
