<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì…ì ì‹œìŠ¤í…œ ì‹œë®¬ë ˆì´ì…˜</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0a0a0a;
            --primary-color: #1a1a1a;
            --secondary-color: #2a2a2a;
            --text-color: #e0e0e0;
            --accent-color: #00aaff;
            --button-bg: #333;
            --button-hover: #555;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            overflow: hidden;
        }
        
        .container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        canvas {
            display: block;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            cursor: crosshair;
        }
        
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(26, 26, 26, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
            min-width: 280px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .back-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .back-button:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: translateY(-2px);
        }
        
        h1 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--accent-color);
            text-align: center;
        }
        
        .control-group {
            margin-bottom: 16px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .control-row {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        input[type="range"] {
            flex: 1;
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            background: var(--secondary-color);
            border-radius: 3px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: var(--accent-color);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 10px var(--accent-color);
        }
        
        .value-display {
            min-width: 40px;
            text-align: right;
            font-size: 0.85rem;
            color: var(--accent-color);
        }
        
        select {
            width: 100%;
            padding: 8px 12px;
            background: var(--secondary-color);
            color: var(--text-color);
            border: 1px solid #444;
            border-radius: 6px;
            outline: none;
            transition: border-color 0.2s ease;
        }
        
        select:focus {
            border-color: var(--accent-color);
        }
        
        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 16px;
        }
        
        button {
            padding: 10px 16px;
            background: var(--button-bg);
            color: var(--text-color);
            border: 1px solid #555;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }
        
        button:hover {
            background: var(--button-hover);
            border-color: var(--accent-color);
        }
        
        button.active {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: #000;
        }
        
        .stats {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 12px 16px;
            font-size: 0.85rem;
            color: #ccc;
        }
        
        .color-picker {
            width: 100%;
            height: 40px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: var(--secondary-color);
        }
        
        /* ë„ì›€ë§ ì„œë íŒ¨ë„ ìŠ¤íƒ€ì¼ */
        .help-panel {
            position: fixed;
            top: 0;
            right: -450px;
            width: 450px;
            height: 100vh;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(15px);
            z-index: 1000;
            overflow-y: auto;
            transition: right 0.3s ease-in-out;
            border-left: 2px solid var(--accent-color);
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
        }
        
        .help-panel.open {
            right: 0;
        }
        
        .help-content {
            padding: 20px;
            height: 100%;
        }
        
        .help-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--secondary-color);
        }
        
        .help-header h2 {
            color: var(--accent-color);
            font-size: 1.4rem;
            margin: 0;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }
        
        .close-btn:hover {
            background: var(--secondary-color);
            transform: rotate(90deg);
        }
        
        .help-sections {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .help-section {
            background: var(--secondary-color);
            border-radius: 10px;
            padding: 15px;
            border-left: 3px solid var(--accent-color);
        }
        
        .help-section h3 {
            color: var(--accent-color);
            font-size: 1.1rem;
            margin-bottom: 10px;
        }
        
        .help-section p {
            margin-bottom: 10px;
            line-height: 1.5;
            font-size: 0.9rem;
        }
        
        .help-section ul, .help-section ol {
            margin-left: 15px;
            line-height: 1.5;
            font-size: 0.9rem;
        }
        
        .help-section li {
            margin-bottom: 6px;
        }
        
        .physics-laws, .interaction-guide {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .law-item, .interaction-item {
            background: var(--bg-color);
            padding: 10px 12px;
            border-radius: 6px;
            border-left: 2px solid var(--accent-color);
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        .law-item strong, .interaction-item strong {
            color: var(--accent-color);
        }
        
        @media (max-width: 768px) {
            .controls {
                top: 10px;
                left: 10px;
                right: 10px;
                min-width: unset;
                padding: 16px;
            }
            
            .back-button {
                top: 10px;
                right: 10px;
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            
            .stats {
                bottom: 10px;
                left: 10px;
                right: 10px;
            }
            
            .help-panel {
                width: 100vw;
                right: -100vw;
            }
            
            .help-content {
                padding: 15px;
            }
            
            .help-header h2 {
                font-size: 1.2rem;
            }
            
            .help-section {
                padding: 12px;
            }
            
            .help-section h3 {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <canvas id="canvas"></canvas>
        
        <div class="controls">
            <h1>ğŸŒŸ ì…ì ì‹œìŠ¤í…œ</h1>
            
            <div class="control-group">
                <label>ì´ë¯¸í„° ëª¨ë“œ</label>
                <select id="emitterMode">
                    <option value="fountain">ë¶„ìˆ˜ íš¨ê³¼</option>
                    <option value="explosion">í­ë°œ íš¨ê³¼</option>
                    <option value="rain">ë¹„ íš¨ê³¼</option>
                    <option value="fireworks">ë¶ˆê½ƒë†€ì´</option>
                    <option value="galaxy">ì€í•˜ íš¨ê³¼</option>
                    <option value="smoke">ì—°ê¸° íš¨ê³¼</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>ì…ì ìˆ˜</label>
                <div class="control-row">
                    <input type="range" id="particleCount" min="50" max="2000" value="500">
                    <span class="value-display" id="particleCountValue">500</span>
                </div>
            </div>
            
            <div class="control-group">
                <label>ì…ì í¬ê¸°</label>
                <div class="control-row">
                    <input type="range" id="particleSize" min="1" max="20" value="3">
                    <span class="value-display" id="particleSizeValue">3</span>
                </div>
            </div>
            
            <div class="control-group">
                <label>ì†ë„</label>
                <div class="control-row">
                    <input type="range" id="velocity" min="0.1" max="5" step="0.1" value="2">
                    <span class="value-display" id="velocityValue">2.0</span>
                </div>
            </div>
            
            <div class="control-group">
                <label>ì¤‘ë ¥</label>
                <div class="control-row">
                    <input type="range" id="gravity" min="-1" max="2" step="0.1" value="0.2">
                    <span class="value-display" id="gravityValue">0.2</span>
                </div>
            </div>
            
            <div class="control-group">
                <label>ë°”ëŒ</label>
                <div class="control-row">
                    <input type="range" id="wind" min="-2" max="2" step="0.1" value="0">
                    <span class="value-display" id="windValue">0.0</span>
                </div>
            </div>
            
            <div class="control-group">
                <label>ìˆ˜ëª… (ì´ˆ)</label>
                <div class="control-row">
                    <input type="range" id="lifespan" min="1" max="10" step="0.5" value="3">
                    <span class="value-display" id="lifespanValue">3.0</span>
                </div>
            </div>
            
            <div class="control-group">
                <label>ìƒ‰ìƒ</label>
                <input type="color" id="colorPicker" value="#00aaff" class="color-picker">
            </div>
            
            <div class="button-group">
                <button id="pauseBtn">ì¼ì‹œì •ì§€</button>
                <button id="clearBtn">í™”ë©´ ì§€ìš°ê¸°</button>
                <button id="trailsBtn">ê¶¤ì  íš¨ê³¼</button>
                <button id="attractorBtn">ì¸ë ¥ì¥</button>
            </div>
            
            <div class="button-group" style="margin-top: 8px;">
                <button id="helpBtn">ğŸ“š í•™ìŠµ ê°€ì´ë“œ</button>
                <button id="resetBtn">âš¡ ì´ˆê¸°í™”</button>
            </div>
        </div>
        
        <!-- í•™ìŠµ ê°€ì´ë“œ íŒ¨ë„ -->
        <div class="help-panel" id="helpPanel">
            <div class="help-content">
                <div class="help-header">
                    <h2>ğŸ“ ì…ì ì‹œìŠ¤í…œ í•™ìŠµ ê°€ì´ë“œ</h2>
                    <button class="close-btn" id="closeHelpBtn">âœ•</button>
                </div>
                
                <div class="help-sections">
                    <div class="help-section">
                        <h3>ğŸŒŸ ê¶¤ì  íš¨ê³¼ (Trails)</h3>
                        <p><strong>ë¬¼ë¦¬í•™ ê°œë…:</strong> ê´€ì„±ê³¼ ìš´ë™ ê¶¤ì </p>
                        <p>ì…ìë“¤ì´ ì›€ì§ì´ë©´ì„œ ë‚¨ê¸°ëŠ” ìì·¨ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤. ì‹¤ì œ ë¬¼ë¦¬í•™ì—ì„œëŠ” ë¬¼ì²´ì˜ ìš´ë™ ê²½ë¡œë¥¼ ì¶”ì í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê°œë…ì…ë‹ˆë‹¤.</p>
                        <ul>
                            <li><strong>í™œìš© ì˜ˆ:</strong> ìœ ì„±ì˜ ê¶¤ì , ë¶ˆê½ƒë†€ì´ì˜ ì”ìƒ</li>
                            <li><strong>ì¡°ì‘ë²•:</strong> 'ê¶¤ì  íš¨ê³¼' ë²„íŠ¼ì„ ëˆŒëŸ¬ ON/OFF</li>
                            <li><strong>ê´€ì°° í¬ì¸íŠ¸:</strong> ì†ë„ê°€ ë¹ ë¥¼ìˆ˜ë¡ ê¸´ ê¶¤ì  ìƒì„±</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h3>ğŸ§² ì¸ë ¥ì¥ (Gravitational Field)</h3>
                        <p><strong>ë¬¼ë¦¬í•™ ê°œë…:</strong> ì¤‘ë ¥ì¥ê³¼ ì¸ë ¥</p>
                        <p>ë§ˆìš°ìŠ¤ ì»¤ì„œ ìœ„ì¹˜ì— ê°€ìƒì˜ ì¤‘ë ¥ì¥ì„ ë§Œë“¤ì–´ ì…ìë“¤ì´ ëŒë ¤ì˜¤ê²Œ í•˜ëŠ” íš¨ê³¼ì…ë‹ˆë‹¤.</p>
                        <ul>
                            <li><strong>í™œìš© ì˜ˆ:</strong> ë¸”ë™í™€ì˜ ì¤‘ë ¥, ìê¸°ì¥ì˜ ì¸ë ¥</li>
                            <li><strong>ì¡°ì‘ë²•:</strong> 'ì¸ë ¥ì¥' ë²„íŠ¼ í™œì„±í™” í›„ ë§ˆìš°ìŠ¤ ì´ë™</li>
                            <li><strong>ê´€ì°° í¬ì¸íŠ¸:</strong> ê±°ë¦¬ì— ë”°ë¥¸ ì¸ë ¥ì˜ ë³€í™”</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h3>ğŸ”¬ ì£¼ìš” ë¬¼ë¦¬ ë²•ì¹™</h3>
                        <div class="physics-laws">
                            <div class="law-item">
                                <strong>ë‰´í„´ ì œ1ë²•ì¹™ (ê´€ì„±):</strong> ì…ìëŠ” ì™¸ë ¥ì´ ì—†ìœ¼ë©´ ê³„ì† ì§ì§„
                            </div>
                            <div class="law-item">
                                <strong>ë‰´í„´ ì œ2ë²•ì¹™ (F=ma):</strong> ì¤‘ë ¥ì´ í´ìˆ˜ë¡ ê°€ì†ë„ ì¦ê°€
                            </div>
                            <div class="law-item">
                                <strong>ì—ë„ˆì§€ ë³´ì¡´:</strong> ì…ì ìˆ˜ëª…ì— ë”°ë¥¸ ì—ë„ˆì§€ ê°ì†Œ
                            </div>
                        </div>
                    </div>
                    
                    <div class="help-section">
                        <h3>ğŸ® ìƒí˜¸ì‘ìš© ê°€ì´ë“œ</h3>
                        <div class="interaction-guide">
                            <div class="interaction-item">
                                <strong>í´ë¦­:</strong> ìƒˆë¡œìš´ ì…ì ë°©ì¶œ ìœ„ì¹˜ ì„¤ì •
                            </div>
                            <div class="interaction-item">
                                <strong>ë“œë˜ê·¸:</strong> ì¸ë ¥ì¥ ëª¨ë“œì—ì„œ ì¸ë ¥ ì¤‘ì‹¬ ì´ë™
                            </div>
                            <div class="interaction-item">
                                <strong>ìŠ¬ë¼ì´ë”:</strong> ì‹¤ì‹œê°„ ë¬¼ë¦¬ íŒŒë¼ë¯¸í„° ì¡°ì •
                            </div>
                            <div class="interaction-item">
                                <strong>ëª¨ë“œ ë³€ê²½:</strong> ë‹¤ì–‘í•œ ìì—° í˜„ìƒ ì‹œë®¬ë ˆì´ì…˜
                            </div>
                        </div>
                    </div>
                    
                    <div class="help-section">
                        <h3>ğŸ§ª ì‹¤í—˜ ì•„ì´ë””ì–´</h3>
                        <ol>
                            <li>ì¤‘ë ¥ì„ ìŒìˆ˜ë¡œ ì„¤ì •í•´ì„œ ë°˜ì¤‘ë ¥ íš¨ê³¼ ê´€ì°°</li>
                            <li>ë°”ëŒ ê°’ì„ ë³€ê²½í•˜ë©° ì…ì ê¶¤ì  ë³€í™” í™•ì¸</li>
                            <li>ì¸ë ¥ì¥ê³¼ ì¤‘ë ¥ì„ ë™ì‹œì— í™œìš©í•œ ë³µì¡í•œ ê¶¤ë„</li>
                            <li>ë‹¤ì–‘í•œ ì´ë¯¸í„° ëª¨ë“œë¡œ ìì—° í˜„ìƒ ì¬í˜„</li>
                            <li>ì…ì ìˆ˜ì™€ ì„±ëŠ¥ì˜ ê´€ê³„ íƒêµ¬</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        
        <a href="../../index.html" class="back-button">
            â† ë©”ì¸ìœ¼ë¡œ
        </a>
        
        <div class="stats">
            <div>í™œì„± ì…ì: <span id="activeParticles">0</span></div>
            <div>FPS: <span id="fpsCounter">60</span></div>
        </div>
    </div>

    <script>
        class Particle {
            constructor(x, y, config = {}) {
                this.x = x;
                this.y = y;
                this.vx = config.vx || (Math.random() - 0.5) * 4;
                this.vy = config.vy || (Math.random() - 0.5) * 4;
                this.size = config.size || Math.random() * 5 + 2;
                this.originalSize = this.size;
                this.life = config.life || 1.0;
                this.maxLife = this.life;
                this.color = config.color || `hsl(${Math.random() * 360}, 70%, 60%)`;
                this.alpha = 1.0;
                this.angle = Math.random() * Math.PI * 2;
                this.angularVelocity = (Math.random() - 0.5) * 0.1;
                this.trail = [];
                this.maxTrailLength = 15;
            }
            
            update(deltaTime, gravity, wind, canvas) {
                // ë¬¼ë¦¬ ì—…ë°ì´íŠ¸
                this.vy += gravity * deltaTime;
                this.vx += wind * deltaTime;
                
                // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
                this.x += this.vx * deltaTime * 60;
                this.y += this.vy * deltaTime * 60;
                
                // ê°ë„ ì—…ë°ì´íŠ¸
                this.angle += this.angularVelocity;
                
                // ìˆ˜ëª… ê°ì†Œ
                this.life -= deltaTime;
                
                // ê¶¤ì  ì €ì¥
                if (particleSystem.trailsEnabled) {
                    this.trail.push({x: this.x, y: this.y, alpha: this.alpha});
                    if (this.trail.length > this.maxTrailLength) {
                        this.trail.shift();
                    }
                }
                
                // íˆ¬ëª…ë„ì™€ í¬ê¸° ê³„ì‚°
                const lifeRatio = this.life / this.maxLife;
                this.alpha = Math.max(0, lifeRatio);
                this.size = this.originalSize * (0.5 + lifeRatio * 0.5);
                
                // ê²½ê³„ í™•ì¸
                return this.life > 0 && 
                       this.x > -50 && this.x < canvas.width + 50 && 
                       this.y > -50 && this.y < canvas.height + 50;
            }
            
            draw(ctx) {
                if (this.alpha <= 0) return;
                
                ctx.save();
                
                // ê¶¤ì  ê·¸ë¦¬ê¸°
                if (particleSystem.trailsEnabled && this.trail.length > 1) {
                    ctx.strokeStyle = this.color;
                    ctx.lineWidth = 1;
                    ctx.globalAlpha = this.alpha * 0.3;
                    ctx.beginPath();
                    for (let i = 0; i < this.trail.length; i++) {
                        const point = this.trail[i];
                        const alpha = (i / this.trail.length) * this.alpha * 0.5;
                        if (i === 0) {
                            ctx.moveTo(point.x, point.y);
                        } else {
                            ctx.lineTo(point.x, point.y);
                        }
                    }
                    ctx.stroke();
                }
                
                // ì…ì ê·¸ë¦¬ê¸°
                ctx.globalAlpha = this.alpha;
                ctx.fillStyle = this.color;
                
                // íšŒì „ëœ ì‚¬ê°í˜• ì…ì
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);
                
                // ê·¸ë¼ë””ì–¸íŠ¸ íš¨ê³¼
                const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, this.size);
                gradient.addColorStop(0, this.color);
                gradient.addColorStop(1, 'transparent');
                ctx.fillStyle = gradient;
                
                ctx.beginPath();
                ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                ctx.fill();
                
                // ë‚´ë¶€ í•˜ì´ë¼ì´íŠ¸
                ctx.globalAlpha = this.alpha * 0.8;
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.arc(-this.size * 0.3, -this.size * 0.3, this.size * 0.3, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.restore();
            }
        }
        
        class ParticleSystem {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.particles = [];
                this.maxParticles = 500;
                this.emitterX = canvas.width / 2;
                this.emitterY = canvas.height / 2;
                this.emitterMode = 'fountain';
                this.isRunning = true;
                this.trailsEnabled = false;
                this.attractorMode = false;
                this.attractorX = 0;
                this.attractorY = 0;
                
                // ì„¤ì •
                this.config = {
                    particleSize: 3,
                    velocity: 2.0,
                    gravity: 0.2,
                    wind: 0.0,
                    lifespan: 3.0,
                    color: '#00aaff'
                };
                
                // FPS ì¹´ìš´í„°
                this.frameCount = 0;
                this.lastTime = 0;
                this.fps = 60;
                
                this.setupEvents();
                this.resize();
            }
            
            setupEvents() {
                // ìº”ë²„ìŠ¤ í´ë¦­ ì´ë²¤íŠ¸
                this.canvas.addEventListener('click', (e) => {
                    const rect = this.canvas.getBoundingClientRect();
                    this.emitterX = e.clientX - rect.left;
                    this.emitterY = e.clientY - rect.top;
                    
                    if (this.emitterMode === 'explosion' || this.emitterMode === 'fireworks') {
                        this.createExplosion(this.emitterX, this.emitterY);
                    }
                });
                
                // ë§ˆìš°ìŠ¤ ì´ë™ ì´ë²¤íŠ¸
                this.canvas.addEventListener('mousemove', (e) => {
                    const rect = this.canvas.getBoundingClientRect();
                    this.attractorX = e.clientX - rect.left;
                    this.attractorY = e.clientY - rect.top;
                    
                    if (!this.attractorMode) {
                        this.emitterX = this.attractorX;
                        this.emitterY = this.attractorY;
                    }
                });
                
                // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ
                window.addEventListener('resize', () => this.resize());
            }
            
            resize() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
                this.emitterX = this.canvas.width / 2;
                this.emitterY = this.canvas.height / 2;
            }
            
            createParticle(x, y, config = {}) {
                const baseConfig = {
                    size: this.config.particleSize + Math.random() * 2,
                    life: this.config.lifespan + Math.random() * 2,
                    color: this.config.color,
                    ...config
                };
                
                return new Particle(x, y, baseConfig);
            }
            
            createExplosion(x, y) {
                const particleCount = 50 + Math.random() * 50;
                for (let i = 0; i < particleCount; i++) {
                    const angle = (Math.PI * 2 * i) / particleCount + Math.random() * 0.5;
                    const speed = this.config.velocity * (2 + Math.random() * 3);
                    
                    const particle = this.createParticle(x, y, {
                        vx: Math.cos(angle) * speed,
                        vy: Math.sin(angle) * speed,
                        color: `hsl(${Math.random() * 60 + 15}, 90%, ${50 + Math.random() * 30}%)`
                    });
                    
                    this.particles.push(particle);
                }
            }
            
            emitParticles(deltaTime) {
                if (!this.isRunning) return;
                
                const emissionRate = this.maxParticles / 2; // ì´ˆë‹¹ ì…ì ìˆ˜
                const particlesToEmit = Math.floor(emissionRate * deltaTime);
                
                for (let i = 0; i < particlesToEmit && this.particles.length < this.maxParticles; i++) {
                    let particle;
                    
                    switch (this.emitterMode) {
                        case 'fountain':
                            particle = this.createParticle(
                                this.emitterX + (Math.random() - 0.5) * 20,
                                this.emitterY,
                                {
                                    vx: (Math.random() - 0.5) * this.config.velocity,
                                    vy: -Math.random() * this.config.velocity * 3,
                                    color: `hsl(${200 + Math.random() * 60}, 70%, 60%)`
                                }
                            );
                            break;
                            
                        case 'rain':
                            particle = this.createParticle(
                                Math.random() * this.canvas.width,
                                -10,
                                {
                                    vx: this.config.wind * 0.5,
                                    vy: Math.random() * 2 + 2,
                                    color: `hsl(${200 + Math.random() * 40}, 50%, 80%)`,
                                    size: 1 + Math.random() * 2
                                }
                            );
                            break;
                            
                        case 'galaxy':
                            const angle = Math.random() * Math.PI * 2;
                            const radius = Math.random() * 100;
                            const centerX = this.emitterX;
                            const centerY = this.emitterY;
                            
                            particle = this.createParticle(
                                centerX + Math.cos(angle) * radius,
                                centerY + Math.sin(angle) * radius,
                                {
                                    vx: -Math.sin(angle) * this.config.velocity * 0.5,
                                    vy: Math.cos(angle) * this.config.velocity * 0.5,
                                    color: `hsl(${250 + Math.random() * 60}, 80%, 70%)`
                                }
                            );
                            break;
                            
                        case 'smoke':
                            particle = this.createParticle(
                                this.emitterX + (Math.random() - 0.5) * 30,
                                this.emitterY + Math.random() * 20,
                                {
                                    vx: (Math.random() - 0.5) * this.config.velocity * 0.5,
                                    vy: -Math.random() * this.config.velocity,
                                    color: `hsl(0, 0%, ${20 + Math.random() * 40}%)`,
                                    size: 3 + Math.random() * 5
                                }
                            );
                            break;
                            
                        default:
                            particle = this.createParticle(
                                this.emitterX + (Math.random() - 0.5) * 10,
                                this.emitterY + (Math.random() - 0.5) * 10,
                                {
                                    vx: (Math.random() - 0.5) * this.config.velocity * 2,
                                    vy: (Math.random() - 0.5) * this.config.velocity * 2
                                }
                            );
                    }
                    
                    if (particle) {
                        this.particles.push(particle);
                    }
                }
            }
            
            updateParticles(deltaTime) {
                // ì¸ë ¥ì¥ íš¨ê³¼
                if (this.attractorMode) {
                    this.particles.forEach(particle => {
                        const dx = this.attractorX - particle.x;
                        const dy = this.attractorY - particle.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance > 0) {
                            const force = 50 / (distance + 10);
                            particle.vx += (dx / distance) * force * deltaTime;
                            particle.vy += (dy / distance) * force * deltaTime;
                        }
                    });
                }
                
                // ì…ì ì—…ë°ì´íŠ¸ ë° ì œê±°
                this.particles = this.particles.filter(particle => 
                    particle.update(deltaTime, this.config.gravity, this.config.wind, this.canvas)
                );
            }
            
            render() {
                // ë°°ê²½ ì²˜ë¦¬
                if (this.trailsEnabled) {
                    this.ctx.fillStyle = 'rgba(10, 10, 10, 0.1)';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                } else {
                    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                }
                
                // ì…ì ë Œë”ë§
                this.particles.forEach(particle => particle.draw(this.ctx));
                
                // ì´ë¯¸í„° í‘œì‹œ
                this.ctx.save();
                this.ctx.strokeStyle = '#00aaff';
                this.ctx.lineWidth = 2;
                this.ctx.setLineDash([5, 5]);
                this.ctx.beginPath();
                this.ctx.arc(this.emitterX, this.emitterY, 10, 0, Math.PI * 2);
                this.ctx.stroke();
                this.ctx.restore();
                
                // ì¸ë ¥ì¥ í‘œì‹œ
                if (this.attractorMode) {
                    this.ctx.save();
                    this.ctx.strokeStyle = '#ff4444';
                    this.ctx.lineWidth = 3;
                    this.ctx.beginPath();
                    this.ctx.arc(this.attractorX, this.attractorY, 15, 0, Math.PI * 2);
                    this.ctx.stroke();
                    this.ctx.restore();
                }
            }
            
            animate(currentTime) {
                if (this.lastTime === 0) this.lastTime = currentTime;
                const deltaTime = (currentTime - this.lastTime) / 1000;
                this.lastTime = currentTime;
                
                // FPS ê³„ì‚°
                this.frameCount++;
                if (this.frameCount % 60 === 0) {
                    this.fps = Math.round(1 / deltaTime);
                }
                
                this.emitParticles(deltaTime);
                this.updateParticles(deltaTime);
                this.render();
                
                // UI ì—…ë°ì´íŠ¸
                document.getElementById('activeParticles').textContent = this.particles.length;
                document.getElementById('fpsCounter').textContent = this.fps;
                
                requestAnimationFrame((time) => this.animate(time));
            }
            
            clear() {
                this.particles = [];
            }
            
            pause() {
                this.isRunning = !this.isRunning;
            }
            
            toggleTrails() {
                this.trailsEnabled = !this.trailsEnabled;
                this.particles.forEach(particle => particle.trail = []);
            }
            
            toggleAttractor() {
                this.attractorMode = !this.attractorMode;
            }
        }
        
        // ì´ˆê¸°í™”
        const canvas = document.getElementById('canvas');
        const particleSystem = new ParticleSystem(canvas);
        
        // ì»¨íŠ¸ë¡¤ ì´ë²¤íŠ¸ ì„¤ì •
        function setupControls() {
            // ìŠ¬ë¼ì´ë” ì»¨íŠ¸ë¡¤
            const controls = [
                { id: 'particleCount', prop: 'maxParticles', display: 'particleCountValue' },
                { id: 'particleSize', prop: 'particleSize', display: 'particleSizeValue', target: 'config' },
                { id: 'velocity', prop: 'velocity', display: 'velocityValue', target: 'config' },
                { id: 'gravity', prop: 'gravity', display: 'gravityValue', target: 'config' },
                { id: 'wind', prop: 'wind', display: 'windValue', target: 'config' },
                { id: 'lifespan', prop: 'lifespan', display: 'lifespanValue', target: 'config' }
            ];
            
            controls.forEach(control => {
                const element = document.getElementById(control.id);
                const display = document.getElementById(control.display);
                
                element.addEventListener('input', (e) => {
                    const value = parseFloat(e.target.value);
                    if (control.target === 'config') {
                        particleSystem.config[control.prop] = value;
                    } else {
                        particleSystem[control.prop] = value;
                    }
                    display.textContent = control.id === 'particleCount' ? Math.round(value) : value.toFixed(1);
                });
                
                // ì´ˆê¸°ê°’ ì„¤ì •
                display.textContent = control.id === 'particleCount' ? 
                    Math.round(element.value) : parseFloat(element.value).toFixed(1);
            });
            
            // ì´ë¯¸í„° ëª¨ë“œ
            document.getElementById('emitterMode').addEventListener('change', (e) => {
                particleSystem.emitterMode = e.target.value;
            });
            
            // ìƒ‰ìƒ ì„ íƒ
            document.getElementById('colorPicker').addEventListener('change', (e) => {
                particleSystem.config.color = e.target.value;
            });
            
            // ë²„íŠ¼ ì»¨íŠ¸ë¡¤
            document.getElementById('pauseBtn').addEventListener('click', () => {
                particleSystem.pause();
                const btn = document.getElementById('pauseBtn');
                btn.textContent = particleSystem.isRunning ? 'ì¼ì‹œì •ì§€' : 'ì¬ìƒ';
                btn.classList.toggle('active');
            });
            
            document.getElementById('clearBtn').addEventListener('click', () => {
                particleSystem.clear();
            });
            
            document.getElementById('trailsBtn').addEventListener('click', () => {
                particleSystem.toggleTrails();
                document.getElementById('trailsBtn').classList.toggle('active');
            });
            
            document.getElementById('attractorBtn').addEventListener('click', () => {
                particleSystem.toggleAttractor();
                document.getElementById('attractorBtn').classList.toggle('active');
            });
            
            // ë„ì›€ë§ ì„œë íŒ¨ë„ ì»¨íŠ¸ë¡¤
            document.getElementById('helpBtn').addEventListener('click', () => {
                const panel = document.getElementById('helpPanel');
                panel.classList.toggle('open');
                
                const btn = document.getElementById('helpBtn');
                if (panel.classList.contains('open')) {
                    btn.textContent = 'ğŸ“š ê°€ì´ë“œ ë‹«ê¸°';
                    btn.classList.add('active');
                } else {
                    btn.textContent = 'ğŸ“š í•™ìŠµ ê°€ì´ë“œ';
                    btn.classList.remove('active');
                }
            });
            
            document.getElementById('closeHelpBtn').addEventListener('click', () => {
                const panel = document.getElementById('helpPanel');
                panel.classList.remove('open');
                
                const btn = document.getElementById('helpBtn');
                btn.textContent = 'ğŸ“š í•™ìŠµ ê°€ì´ë“œ';
                btn.classList.remove('active');
            });
            
            // ì´ˆê¸°í™” ë²„íŠ¼
            document.getElementById('resetBtn').addEventListener('click', () => {
                // ëª¨ë“  ì„¤ì •ì„ ì´ˆê¸°ê°’ìœ¼ë¡œ ë³µì›
                document.getElementById('particleCount').value = 500;
                document.getElementById('particleSize').value = 3;
                document.getElementById('velocity').value = 2.0;
                document.getElementById('gravity').value = 0.2;
                document.getElementById('wind').value = 0.0;
                document.getElementById('lifespan').value = 3.0;
                document.getElementById('colorPicker').value = '#00aaff';
                document.getElementById('emitterMode').value = 'fountain';
                
                // íŒŒí‹°í´ ì‹œìŠ¤í…œ ì„¤ì • ì—…ë°ì´íŠ¸
                particleSystem.maxParticles = 500;
                particleSystem.config = {
                    particleSize: 3,
                    velocity: 2.0,
                    gravity: 0.2,
                    wind: 0.0,
                    lifespan: 3.0,
                    color: '#00aaff'
                };
                particleSystem.emitterMode = 'fountain';
                particleSystem.trailsEnabled = false;
                particleSystem.attractorMode = false;
                
                // UI ì—…ë°ì´íŠ¸
                document.getElementById('particleCountValue').textContent = '500';
                document.getElementById('particleSizeValue').textContent = '3';
                document.getElementById('velocityValue').textContent = '2.0';
                document.getElementById('gravityValue').textContent = '0.2';
                document.getElementById('windValue').textContent = '0.0';
                document.getElementById('lifespanValue').textContent = '3.0';
                
                // ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”
                document.getElementById('trailsBtn').classList.remove('active');
                document.getElementById('attractorBtn').classList.remove('active');
                document.getElementById('pauseBtn').classList.remove('active');
                document.getElementById('pauseBtn').textContent = 'ì¼ì‹œì •ì§€';
                document.getElementById('helpBtn').classList.remove('active');
                document.getElementById('helpBtn').textContent = 'ğŸ“š í•™ìŠµ ê°€ì´ë“œ';
                
                // ê°€ì´ë“œ íŒ¨ë„ ë‹«ê¸°
                document.getElementById('helpPanel').classList.remove('open');
                
                // ì…ì ì´ˆê¸°í™”
                particleSystem.clear();
                particleSystem.isRunning = true;
            });
        }
        
        // ì‹œì‘
        setupControls();
        particleSystem.animate(0);
    </script>
</body>
</html>
